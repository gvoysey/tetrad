%% BE 561: Final Project
%  Antigen Tetrad-Set Selection 
%  Perna Data Formater 

%% Init Settings 
clear all;
close all; 
set(groot, ...
    'DefaultAxesLineWidth', 1,          ...
    'DefaultAxesXColor', 'k',           ...
    'DefaultAxesYColor', 'k',           ...
    'DefaultAxesFontUnits', 'points',   ...
    'DefaultAxesFontSize', 16,          ...
    'DefaultAxesFontName', 'Helvetica', ...
    'DefaultLineLineWidth', 1,          ...
    'DefaultTextFontUnits', 'Points',   ...
    'DefaultTextFontSize', 20,          ...
    'DefaultTextFontName', 'Helvetica', ...
    'DefaultAxesBox', 'off'  );
set(groot, 'DefaultAxesTickDir', 'in');
set(groot, 'DefaultAxesTickDirMode', 'auto');

expression = [
    2 1 1 2 1 1 2 1 2 1 2 2 0 1 2 2 1 2 1 2 1 2 1 2 0 2 2 1 2 2 2 2 1 1 2 0 2 1 2 2 0 3 1;  
    0 1 1 1 1 0 1 2 2 0 2 2 1 1 2 2 0 1 0 1 0 2 2 1 1 1 2 1 2 2 2 2 2 2 2 2 1 0 2 2 0 3 2;
    0 2 1 2 2 1 2 1 1 1 1 2 2 1 0 2 2 2 1 0 1 2 2 0 0 2 2 1 2 0 2 0 0 2 0 0 1 2 2 2 0 1 1;
    0 1 1 2 1 1 2 2 2 1 1 2 1 1 1 2 2 1 2 1 0 1 1 2 0 0 1 1 2 1 2 0 0 0 0 0 2 1 1 1 0 1 0;
    0 0 2 1 2 2 2 1 2 0 1 0 2 2 1 2 0 2 0 0 0 2 2 2 0 1 1 2 2 1 2 0 2 1 0 0 1 1 1 1 0 1 0;
    0 2 1 2 1 0 1 1 2 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 0 2 1 1 1 1 0 1;
    0 0 1 2 0 1 2 0 0 2 2 2 0 2 2 1 0 1 0 1 1 0 2 1 0 1 0 0 0 2 2 0 2 1 1 0 2 0 2 1 0 2 1;
    0 0 0 0 0 0 1 0 0 0 0 2 0 1 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 2 2 0 0 0 2 0 0 0 2 0 0 2 1;
    0 0 2 0 0 0 0 1 2 0 0 1 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 2 0 0 0 0 2 0 0 0 2 0 0 2 1;
    0 0 1 0 4 0 0 0 0 0 0 1 0 0 0 1 4 0 4 4 0 0 4 2 0 0 4 4 0 0 2 4 0 0 0 0 1 0 0 0 4 3 1;
    0 0 0 1 0 0 0 1 1 0 0 1 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 2 0 0 0 0 0 1 1 1 0 0 1 0;
    0 0 0 0 4 0 1 0 0 0 0 1 0 0 1 0 4 0 4 4 0 0 4 0 0 0 4 4 0 0 1 4 0 0 0 0 0 0 0 0 4 2 0;
    0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 4 0 0 1 0 0 0 0 0 0 2 2;
    0 0 0 1 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 2 0 0 0 0 0 0 1 3;
    0 0 0 0 4 0 0 0 0 0 0 0 0 0 0 0 4 0 4 4 0 0 4 0 0 0 4 4 1 0 0 4 0 0 1 0 0 0 0 0 4 2 0;
    0 0 0 0 4 0 0 1 0 0 0 1 0 0 0 0 4 0 4 4 0 0 4 0 0 0 4 4 0 0 1 4 0 0 0 0 1 0 0 0 4 2 0;
    0 0 0 0 0 0 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 1 1;
    0 0 1 0 4 0 0 0 0 0 0 1 0 0 0 0 4 0 4 4 1 0 4 0 0 0 4 4 1 0 0 4 0 0 0 0 1 0 0 0 4 2 0;
    0 0 0 0 4 0 0 1 0 0 0 0 0 0 0 0 4 0 4 4 0 0 4 0 0 0 4 4 1 0 0 4 0 0 0 0 0 0 0 0 4 2 0;
    0 0 0 0 4 0 0 1 0 0 0 0 0 0 0 0 4 0 4 4 0 0 4 0 0 0 4 4 1 0 0 4 0 0 0 0 0 0 0 0 4 2 1;
    0 0 0 0 4 0 1 0 0 0 0 0 0 0 0 0 0 0 4 4 0 0 4 0 0 0 4 4 0 0 1 4 0 0 1 0 0 0 0 0 4 1 0;
    0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 2 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 4 0 1 0 0 0 0 0 0 0 0 0 4 0 4 4 0 0 4 0 0 0 4 4 0 0 0 4 0 0 0 0 0 0 0 0 4 1 0;
    0 0 0 0 4 0 0 0 0 0 0 0 0 0 0 0 4 0 4 4 0 0 4 0 0 0 4 4 0 0 0 4 0 0 0 0 0 0 0 0 4 1 0; 
    
    2 1 3 3 3 2 3 3 0 3 3 3 3 3 3 1 0 3 0 1 3 2 3 3 0 3 2 1 2 3 2 0 3 2 3 3 1 3 3 3 3 3 3;
    0 2 2 2 3 0 3 2 2 3 2 2 3 2 2 3 2 2 2 2 0 3 3 3 0 3 2 2 2 2 1 2 2 1 2 0 2 2 2 2 2 0 2;
    0 2 1 0 4 0 2 1 0 1 1 2 0 2 2 2 4 0 4 4 1 1 4 0 0 1 4 4 2 0 2 4 1 1 0 1 2 0 1 2 4 0 0;
    1 0 0 1 0 0 2 0 0 0 0 2 0 2 0 1 0 0 0 0 1 2 2 0 0 1 0 0 0 3 2 0 2 2 1 0 1 0 3 0 0 2 2;
    0 0 2 1 1 0 3 1 1 0 0 1 0 1 1 2 1 1 1 1 0 2 2 1 0 1 1 1 2 0 0 1 0 1 1 0 2 1 1 1 0 0 0; 
    0 0 1 0 0 0 0 0 0 0 0 2 0 0 0 0 0 2 0 0 0 0 2 0 0 0 0 0 0 2 0 0 2 0 3 0 0 0 2 0 0 2 2; 
    0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0 0 2 3;
    
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0 0 3 0 0 0 0 3 0 0 0 3 0 0 2 2;
];

antigens1 = {   'CCR1',    ...
                'CD70',     ...
                'LILRB4',   ...
                'ADGRE2',   ...
                'LILRA2',   ...
                'LILRA6',   ...
                'LILRB3'	...
                'CD96',     ...
                'EMB',      ...
                'LILRB2',   ...
                'P2RY13',   ...
                'LTB4R',    ...
                'TLR2',     ...
                'SEMA4A',   ...
                'DAGLB',    ...
                'CR1',      ...
                'ITGAX',    ...
                'CD82',     ...
                'TNFRSF1B', ...
                'SLC6A6',   ...
                'EMC10',    ...
                'SLC30A1',  ...
                'PTPRJ',    ...
                'ITGB5'         };
antigens2 = {   'CLEC12_ACLL1',...
                'CD33',        ...
                'FUT3_LeY',    ...
                'CD38',        ...
                'FOLR2',       ...
                'IL3RA_CD12',  ...
                'CD44'          };
            
antigens3 = {   'CD19'};

tissues = {     'Adipose',      ...
                'Adrenal',      ...
                'Bladder',      ...
                'Brain',        ...
                'Bronchus',     ...
                'Eye',          ...
                'Gut',          ...
                'Heart',        ...
                'Kidney',       ...
                'Esophagus',    ...
                'Liver',        ...
                'Lung',         ...
                'Nasopharynx',  ...
                'Oropharynx',   ...
                'Pancreas',     ...
                'Rectum',       ...
                'Skeletal_Muscle',...
                'Skin',         ...
                'Smooth_Muscle',...
                'Soft_Tissue',  ...
                'Spinal_Cord',  ...
                'Stomach',      ...
                'Appendix',     ...
                'Breast',       ...
                'Cerumen',      ...
                'Cervix',       ...
                'Epididymis',   ...
                'Fallopian_tubes',...
                'Gall_bladder', ...
                'Lymph_node',   ...
                'Ovary',        ...
                'Parathyroid',  ...
                'Prostate',     ...
                'Seminal',      ...
                'Spleen',       ...
                'Synovial_fluid',...
                'Testis',       ...
                'Thyroid',      ...
                'Tonsil',       ...
                'Uterus',       ...
                'Vagina',       ...
                'Blood',        ...
                'Bone'              };
        
antigens = [flip(antigens1') ; flip(antigens2') ; {'CD19'}];
tissues = tissues';

Antigens_Perna = struct;
for i = 1:length(antigens)
    Antigens_Perna.(antigens{i}) = struct;
   for j = 1:length(tissues)
       Antigens_Perna.(antigens{i}).(tissues{j}) = struct;
       Antigens_Perna.(antigens{i}).(tissues{j}).data = expression(i,j);
   end
end

save('PERNA_DATA_Unformated','antigens','tissues','expression');
save('PERNA_DATA_formated','Antigens_Perna');

